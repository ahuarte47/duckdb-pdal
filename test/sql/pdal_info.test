# name: test/sql/pdal_info.test
# description: test pdal extension
# group: [sql]

require pdal

query IIIIIIIIIIIIIIIIIII
SELECT
	REPLACE(file_name, '\', '/') AS file_name,
	point_count,
	min_x,
	min_y,
	min_z,
	max_x,
	max_y,
	max_z,
	extra_header,
	scale_x,
	scale_y,
	scale_z,
	offset_x,
	offset_y,
	offset_z,
	point_format,
	point_offset,
	point_len,
	srs_wkt
FROM
	PDAL_Info('./test/data/autzen_trim.la*')
ORDER BY
	file_name
;
----
./test/data/autzen_trim.las	110000	636001.76	848935.20	406.26	637179.22	849497.90	520.51	true	0.01	0.01	0.01	0.0	0.0	0.0	3	2038	34	PROJCS["NAD_1983_HARN_Lambert_Conformal_Conic",GEOGCS["NAD83(HARN)",DATUM["NAD83_High_Accuracy_Reference_Network",SPHEROID["GRS 1980",6378137,298.257222101004,AUTHORITY["EPSG","7019"]],AUTHORITY["EPSG","6152"]],PRIMEM["Greenwich",0],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]]],PROJECTION["Lambert_Conformal_Conic_2SP"],PARAMETER["latitude_of_origin",41.75],PARAMETER["central_meridian",-120.5],PARAMETER["standard_parallel_1",43],PARAMETER["standard_parallel_2",45.5],PARAMETER["false_easting",1312335.95800525],PARAMETER["false_northing",0],UNIT["foot",0.3048,AUTHORITY["EPSG","9002"]],AXIS["Easting",EAST],AXIS["Northing",NORTH]]
./test/data/autzen_trim.laz	110000	636001.76	848935.20	406.26	637179.22	849497.90	520.51	true	0.01	0.01	0.01	0.0	0.0	0.0	3	2144	34	PROJCS["NAD_1983_HARN_Lambert_Conformal_Conic",GEOGCS["NAD83(HARN)",DATUM["NAD83_High_Accuracy_Reference_Network",SPHEROID["GRS 1980",6378137,298.257222101004,AUTHORITY["EPSG","7019"]],AUTHORITY["EPSG","6152"]],PRIMEM["Greenwich",0],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]]],PROJECTION["Lambert_Conformal_Conic_2SP"],PARAMETER["latitude_of_origin",41.75],PARAMETER["central_meridian",-120.5],PARAMETER["standard_parallel_1",43],PARAMETER["standard_parallel_2",45.5],PARAMETER["false_easting",1312335.95800525],PARAMETER["false_northing",0],UNIT["foot",0.3048,AUTHORITY["EPSG","9002"]],AXIS["Easting",EAST],AXIS["Northing",NORTH]]

query IIIIIIIIIII
SELECT
	REPLACE(file_name, '\', '/') AS file_name,
	extra_header,
	scale_x,
	scale_y,
	scale_z,
	offset_x,
	offset_y,
	offset_z,
	point_format,
	point_offset,
	point_len
FROM
	PDAL_Info('./test/data/autzen-utm.bpf')
;
----
./test/data/autzen-utm.bpf	false	0.01	0.01	0.01	0.0	0.0	0.0	0	0	0

query II
SELECT
	UNNEST(dimensions).name AS name,
	UNNEST(dimensions).type AS type
FROM
	PDAL_Info('./test/data/autzen_trim.laz')
;
----
X	double
Y	double
Z	double
Intensity	uint16_t
ReturnNumber	uint8_t
NumberOfReturns	uint8_t
ScanDirectionFlag	uint8_t
EdgeOfFlightLine	uint8_t
Classification	uint8_t
Synthetic	uint8_t
KeyPoint	uint8_t
Withheld	uint8_t
Overlap	uint8_t
ScanAngleRank	float
UserData	uint8_t
PointSourceId	uint16_t
GpsTime	double
Red	uint16_t
Green	uint16_t
Blue	uint16_t
